# 深度学习用于机械臂抓取

> Mahler,J.,Liang,J.,Niyaz,S.,Laskey,M.,Doan,R.,Liu,X.,Ojea,J.A.andGoldberg,K.,2017.Dex-Net2.0:DeepLearningtoPlanRobustGraspswithSyntheticPointCloudsandAnalyticGraspMetrics.arXivpreprintarXiv:1703.09312

### 1. 抓取的难点：

抓取是manipulation里最常见的问题之一。早期对抓取的研究有很多在判定一个稳定的抓取是否形成，比如是否满足force closure \(手指与物体的接触点是否可以产生抵抗任意方向、大小的外力\)。除了通常意义上的稳定抓取，另一种限制物体位置的方式是caging，即通过放置手指，让物体无法离开这一区域。

![](/assets/1232.png)

图1. 抓取示例[^1]：图中黑点代表手的位置。左：摩擦系数不为零时，形成force closure；右：caging

Force closure的判定方法方法很早就有了，左右一种简单直接的抓取算法思路如下：

#### 1.1抓取算法1.0

1. 随便选一个抓取位置.（比如在物体表面采样一堆点，有很多方法）
2. 判断这个抓取的位置能够形成force closure
3. 如果是，执行这个抓取；如果否，回到第一步

这个方法计算量不大，对于多数物体你可以采样几十组点就轻松找到一个不错的抓取。看上去抓取问题就被解决了。但是这只是解决了最简单的清醒，即：

1. 物体形状已知
2. 对物体位置的感知完全精确
3. 环境中没有障碍物

如果这算个假设都被满足，这样的抓取40年前的研究者们已经解决了。然而对于实际中的问题而言，这些假设往往很难满足，而且一旦离开了这些假设，抓取问题可以变得任意困难，比如“抓取任意形状的物体”，“在没有感知的情况下抓取物体”，“把压箱底的书取出来”，也正因如此，对抓取的研究才至非常活跃。

### 2.问题描述

这篇文章尝试解决**基于点云的平面抓取**问题。机器人使用二指平行抓手（parallel gripper），物体放在没有障碍物的平面上，对物体的感知来自于深度摄像头自上而下拍摄的一张图片以及从中获取的物体点云数据。

![](/assets/image.jpg)

抓取过程被简化为“放下，合拢手指，拿起”三步，**机械手始终手指向下**，整个抓取动作只用**三个量描述：手掌平面位置x，y以及手指朝向**。**算法要做的就是根据摄像头数据，给出一组这样的动作参数以实现抓取**。

基于深度摄像头的抓取，传统方法中**最可靠的方式是根据点云数据进行图像分割，物体识别以及物体的位姿估计，再根据物体几何结构选择合适的抓取位置**。这种方法**要求物体模型已知**，同时，在衡量抓取位置优劣时要考虑到感知系统的不确定性，而非简单滴计算是否形成force closure：

#### 2.1 抓取算法2.0

1. 从图像中识别出物体种类，估计物体位姿。

2. 根据物体几何结构随便选N个抓取的位置。

3. 根据某个**评价函数**，为每个抓取位置打分。

4. 选择得分最高的抓取位置执行。

**传统方法的主要缺点是环节多，每一环都有不少参数要调整**，因此整个系统使用起来的人工复杂度比较高。这也催生了近年来比较火的基于深度学习进行抓取的方法，采用卷积神经网络来描述一个从图像直接到抓取位置的映射：

#### 2.2 抓取算法2.0

* 从图像直接获取抓取位置并执行

比如CMU RI的Gupta组，把抓取位置进一步简化为仅判断抓取的角度，并使用多达5万次机器人抓取实验来训练所需的神经网络[^2]。Google DeepMind 尝试从一堆物体中进行抓取，场景更复杂，因而也使用了更大的数据量（超过八十万次抓取，十几台机械臂花了两个多月才收集完数据）[^3]。**这种方法看上去直接，然而实际使用起来采数据所花的人力物力远超过传统方法**。

为了让仿真数据能用来训练神经网络，这篇文章有几个值得注意的地方：

1. 在仿真中认为**引入模型误差**，这样训练出来的结果起码能对付人工引入的噪声；
2. **定量衡量**一个抓取的**抗干扰能力**，以此作为依据在多个候选解中取最优；
3. **把抓取表述成一个规模合适的问题，不考虑复杂的抓取动作**。不考虑背景干扰或遮挡，最重要的是**不做端到端**，神经网络不需要直接输出抓取位置，而是仅需要做一个评价函数，对一个给定的抓取位置打一个分数。问题的复杂度降低后，仿真的失真带来的不利影响也随之变小。使用这样训练出来的神经网络，相比算法2.0我们仍可以省略掉步骤一，于是有了最终版算法：

#### 2.3 抓取算法4.0

1. 在点云上随便选N个抓取的位置。
2. 根据训练好的CNN评价函数，为每个抓取位置打分。
3. 选择得分最高的抓取位置执行。

下面就详细介绍神经网络评价函数是如何得到的。

[^1]: Enter footnote here.

